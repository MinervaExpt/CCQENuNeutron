import ROOT
from ROOT import TMath
def Zexp( Q2, par, scale = 1.):
    a1 = par[0]
    a2 = par[1]
    a3 = par[2]
    a4 = par[3]

    #return scale*(-0.5368587367453468 - 0.18236445891156497*a1 - 0.2599025034120824*a2 - 0.06243339493214775*a3 - 0.04159172230772783*a4 + ((-18.790055786087137 + 13.617243938095227*a1 + 0.9034123805771159*a2 + 1.8148311773748287*a3 - 0.45571028077047404*a4)*TMath.Power(-0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),8))/ TMath.Power(0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),8) + ((64.42304840944162 - 48.1162649306122*a1 - 4.811699590550112*a2 - 7.50799260814227*a3 + 0.9910066769273396*a4)*TMath.Power(-0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),7))/ TMath.Power(0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),7) + ((-75.16022314434855 + 58.468975752380906*a1 + 8.613649522308464*a2 + 11.259324709499316*a3 + 0.17715887691810378*a4)*TMath.Power(-0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),6))/ TMath.Power(0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),6) + ((30.064089257739422 - 24.78759030095236*a1 - 5.445459808923386*a2 - 6.503729883799726*a3 - 1.6708635507672416*a4)*TMath.Power(-0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),5))/ TMath.Power(0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),5) + (a4*TMath.Power(-0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),4))/TMath.Power(0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),4) + (a3*TMath.Power(-0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),3))/TMath.Power(0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),3) + (a2*TMath.Power(-0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),2))/TMath.Power(0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),2) + (a1*(-0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2)))/(0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2)) )

    return scale*(-1.189731573670486 + 0.1806060300153102*a1 - 0.07290143984451301*a2 + 0.0017670719063017247*a3 - 0.0065355373121289825*a4 + ((-41.64060507846701 + 26.321211050535858*a1 + 7.448449605442044*a2 + 4.061847516720561*a3 + 0.7712561940754856*a4)*TMath.Power(-0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),8))/ TMath.Power(0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),8) + ((142.76778884045834 - 91.67272360183722*a1 - 27.251827218658438*a2 - 15.212048628756207*a3 - 3.215735522544522*a4)* TMath.Power(-0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),7))/TMath.Power(0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),7) + ((-166.56242031386805 + 109.28484420214343*a1 + 34.79379842176818*a2 + 20.247390066882243*a3 + 5.0850247763019425*a4)*TMath.Power(-0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),6))/ TMath.Power(0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),6) + ((66.62496812554723 - 45.11393768085737*a1 - 15.917519368707271*a2 - 10.098956026752896*a3 - 3.634009910520777*a4)* TMath.Power(-0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),5))/TMath.Power(0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),5) + (a4*TMath.Power(-0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),4))/TMath.Power(0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),4) + (a3*TMath.Power(-0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),3))/TMath.Power(0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),3) + (a2*TMath.Power(-0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),2))/TMath.Power(0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2),2) + (a1*(-0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2)))/(0.6747729368514208 + TMath.Sqrt(0.17531851630709155 + Q2)))
    #return scale*(-0.5368587367453468 - 0.18236445891156497*a1 - 0.2599025034120824*a2 - 0.06243339493214775*a3 - 0.04159172230772783*a4 + a1*z + a2*TMath.Power(z,2) + a3*TMath.Power(z,3) + a4*TMath.Power(z,4) + (30.064089257739422 - 24.78759030095236*a1 - 5.445459808923386*a2 - 6.503729883799726*a3 - 1.6708635507672416*a4)*TMath.Power(z,5) + (-75.16022314434855 + 58.468975752380906*a1 + 8.613649522308464*a2 + 11.259324709499316*a3 + 0.17715887691810378*a4)*TMath.Power(z,6) + (64.42304840944162 - 48.1162649306122*a1 - 4.811699590550112*a2 - 7.50799260814227*a3 + 0.9910066769273396*a4)*TMath.Power(z,7) + (-18.790055786087137 + 13.617243938095227*a1 + 0.9034123805771159*a2 + 1.8148311773748287*a3 - 0.45571028077047404*a4)*TMath.Power(z,8) )

def FitError(Q2,par,scale=1.):
  c11,c12,c13,c14=par[0]
  c21,c22,c23,c24=par[1]
  c31,c32,c33,c34=par[2]
  c41,c42,c43,c44=par[3]

  err= TMath.Sqrt(((123573.76852053669 + 3.1188993023206704e-29*TMath.Power(Q2,8) - 295128.4383833547*TMath.Sqrt(0.1753196 + Q2) + TMath.Power(Q2,2)*(1.980841461300461e6 - 1.701800107656275e6*TMath.Sqrt(0.1753196 + Q2)) + Q2*(969856.3861109653 - 1.474599121343458e6*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,3)*(1.0433932478530797e6 - 385662.1963067424*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,4)*(65119.32931246298 - 1.229260896416584e-10*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,5)*(7.241803470015132e-11 - 3.017349119604477e-11*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,6)*(2.8502675717218646e-12 - 5.876120728942069e-28*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,7)*(1.763524901817264e-27 - 4.756321436039022e-28*TMath.Sqrt(0.1753196 + Q2)))*c11 + (25724.386564411005 - 61436.971017539756*TMath.Sqrt(0.1753196 + Q2) + Q2*(179844.36112416835 - 254304.00777742843*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,2)*(278499.51236406335 - 175620.8353852*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,4)*(-18704.04491334985 - 3.6249710981862537e-12*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,6)*(-4.09337237034068e-13 - 1.8234942167394265e-28*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,7)*(-1.4132512463640536e-29 + 3.898624127900838e-30*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,5)*(5.3758126583432755e-12 + 2.7560126166375162e-12*TMath.Sqrt(0.1753196 + Q2)) + TMath.Power(Q2,3)*(38618.30553663715 + 30559.905791114656*TMath.Sqrt(0.1753196 + Q2)))*c21 + 1338.7632181931767*c22 + 8211.976449274125*Q2*c22 + 8696.316407494565*TMath.Power(Q2,2)*c22 - 2364.8124848658113*TMath.Power(Q2,3)*c22 + 1343.0777766535427*TMath.Power(Q2,4)*c22 - 1.362921554447591e-13*TMath.Power(Q2,5)*c22 - 1.7997952994098688e-30*TMath.Power(Q2,6)*c22 + 1.2183200399690119e-31*TMath.Power(Q2,7)*c22 - 3197.3379357186473*TMath.Sqrt(0.1753196 + Q2)*c22 - 10493.87949209195*Q2*TMath.Sqrt(0.1753196 + Q2)*c22 - 1750.6688972846894*TMath.Power(Q2,2)*TMath.Sqrt(0.1753196 + Q2)*c22 + 3565.4144840550616*TMath.Power(Q2,3)*TMath.Sqrt(0.1753196 + Q2)*c22 + 3.0510960694579216e-13*TMath.Power(Q2,4)*TMath.Sqrt(0.1753196 + Q2)*c22 - 2.5583577314629296e-14*TMath.Power(Q2,5)*TMath.Sqrt(0.1753196 + Q2)*c22 + 9.746560319752095e-31*TMath.Power(Q2,6)*TMath.Sqrt(0.1753196 + Q2)*c22 + 39641.49319628059*c31 + 295004.5522880786*Q2*c31 + 533648.3155785511*TMath.Power(Q2,2)*c31 + 207833.7847975983*TMath.Power(Q2,3)*c31 + 3688.25137443458*TMath.Power(Q2,4)*c31 + 9.437558411332085e-12*TMath.Power(Q2,5)*c31 + 4.370006728241463e-13*TMath.Power(Q2,6)*c31 - 8.847883191221972e-29*TMath.Power(Q2,7)*c31 + 7.797248255801676e-30*TMath.Power(Q2,8)*c31 - 94674.88223650285*TMath.Sqrt(0.1753196 + Q2)*c31 - 434546.14494854864*Q2*TMath.Sqrt(0.1753196 + Q2)*c31 - 411896.7087549792*TMath.Power(Q2,2)*TMath.Sqrt(0.1753196 + Q2)*c31 - 53924.34816313334*TMath.Power(Q2,3)*TMath.Sqrt(0.1753196 + Q2)*c31 - 2.5569245796070278e-11*TMath.Power(Q2,4)*TMath.Sqrt(0.1753196 + Q2)*c31 - 1.8990396433994915e-12*TMath.Power(Q2,5)*TMath.Sqrt(0.1753196 + Q2)*c31 - 6.2302515790812025e-28*TMath.Power(Q2,6)*TMath.Sqrt(0.1753196 + Q2)*c31 - 4.3859521438884424e-29*TMath.Power(Q2,7)*TMath.Sqrt(0.1753196 + Q2)*c31 + 4126.0904607037155*c32 + 27168.710130122436*Q2*c32 + 35541.93614124969*TMath.Power(Q2,2)*c32 - 508.68458660534384*TMath.Power(Q2,3)*c32 - 529.6831224115867*TMath.Power(Q2,4)*c32 - 3.2490332758767865e-13*TMath.Power(Q2,5)*c32 - 5.116715462925857e-14*TMath.Power(Q2,6)*c32 + 2.9239680959256302e-30*TMath.Power(Q2,7)*c32 - 9854.248590740119*TMath.Sqrt(0.1753196 + Q2)*c32 - 36782.745156151104*Q2*TMath.Sqrt(0.1753196 + Q2)*c32 - 17585.063023951672*TMath.Power(Q2,2)*TMath.Sqrt(0.1753196 + Q2)*c32 + 5472.710939721583*TMath.Power(Q2,3)*TMath.Sqrt(0.1753196 + Q2)*c32 + 9.319953435488338e-13*TMath.Power(Q2,4)*TMath.Sqrt(0.1753196 + Q2)*c32 - 1.6520517498356918e-13*TMath.Power(Q2,5)*TMath.Sqrt(0.1753196 + Q2)*c32 - 1.35124500578822e-30*TMath.Power(Q2,6)*TMath.Sqrt(0.1753196 + Q2)*c32 + 4.8732801598760474e-31*TMath.Power(Q2,7)*TMath.Sqrt(0.1753196 + Q2)*c32 + 3179.169822294452*c33 + 22366.17329556453*Q2*c33 + 35160.84209972916*TMath.Power(Q2,2)*c33 + 9000.095992414572*TMath.Power(Q2,3)*c33 + 52.2241181867321*TMath.Power(Q2,4)*c33 - 4.237724274056085e-15*TMath.Power(Q2,5)*c33 + 1.0089653294864061e-14*TMath.Power(Q2,6)*c33 + 6.531441401179485e-30*TMath.Power(Q2,7)*c33 + 4.8732801598760474e-31*TMath.Power(Q2,8)*c33 - 7592.739432020469*TMath.Sqrt(0.1753196 + Q2)*c33 - 31762.630893744998*Q2*TMath.Sqrt(0.1753196 + Q2)*c33 - 23537.135506458486*TMath.Power(Q2,2)*TMath.Sqrt(0.1753196 + Q2)*c33 - 1217.8013553162882*TMath.Power(Q2,3)*TMath.Sqrt(0.1753196 + Q2)*c33 - 5.906820974380969e-13*TMath.Power(Q2,4)*TMath.Sqrt(0.1753196 + Q2)*c33 - 9.745976405215245e-14*TMath.Power(Q2,5)*TMath.Sqrt(0.1753196 + Q2)*c33 - 1.7100852406855396e-29*TMath.Power(Q2,6)*TMath.Sqrt(0.1753196 + Q2)*c33 + 1.949312063950419e-30*TMath.Power(Q2,7)*TMath.Sqrt(0.1753196 + Q2)*c33 - 3898.338311745743*c41 - 43386.392859288266*Q2*c41 - 133642.83686899114*TMath.Power(Q2,2)*c41 - 107223.34397539348*TMath.Power(Q2,3)*c41 - 11196.158480887285*TMath.Power(Q2,4)*c41 - 1.7139262030220627e-13*TMath.Power(Q2,5)*c41 - 2.450274579211933e-13*TMath.Power(Q2,6)*c41 + 9.844025922949613e-29*TMath.Power(Q2,7)*c41 + 9310.313280964005*TMath.Sqrt(0.1753196 + Q2)*c41 + 77066.3381284591*Q2*TMath.Sqrt(0.1753196 + Q2)*c41 + 140144.13243693073*TMath.Power(Q2,2)*TMath.Sqrt(0.1753196 + Q2)*c41 + 50257.39658355148*TMath.Power(Q2,3)*TMath.Sqrt(0.1753196 + Q2)*c41 - 2.7999162000373292e-12*TMath.Power(Q2,4)*TMath.Sqrt(0.1753196 + Q2)*c41 + 1.8863576019219633e-12*TMath.Power(Q2,5)*TMath.Sqrt(0.1753196 + Q2)*c41 - 3.458254039620425e-28*TMath.Power(Q2,6)*TMath.Sqrt(0.1753196 + Q2)*c41 - 7.797248255801676e-30*TMath.Power(Q2,7)*TMath.Sqrt(0.1753196 + Q2)*c41 - 405.7590979493959*c42 - 4168.0625761632655*Q2*c42 - 10510.714086835927*TMath.Power(Q2,2)*c42 - 3799.0807120514496*TMath.Power(Q2,3)*c42 + 1607.9208223925973*TMath.Power(Q2,4)*c42 - 2.2578277764547638e-13*TMath.Power(Q2,5)*c42 + 1.3778109413472139e-29*TMath.Power(Q2,6)*c42 - 4.8732801598760474e-31*TMath.Power(Q2,7)*c42 + 969.0652827969918*TMath.Sqrt(0.1753196 + Q2)*c42 + 7190.778965955826*Q2*TMath.Sqrt(0.1753196 + Q2)*c42 + 9394.708118535906*TMath.Power(Q2,2)*TMath.Sqrt(0.1753196 + Q2)*c42 - 322.0364833711384*TMath.Power(Q2,3)*TMath.Sqrt(0.1753196 + Q2)*c42 + 2.3850906249564713e-13*TMath.Power(Q2,4)*TMath.Sqrt(0.1753196 + Q2)*c42 + 3.58529385091839e-14*TMath.Power(Q2,5)*TMath.Sqrt(0.1753196 + Q2)*c42 + 4.8732801598760474e-31*TMath.Power(Q2,6)*TMath.Sqrt(0.1753196 + Q2)*c42 - 625.2781375530623*c43 - 6704.776328758013*Q2*c43 - 18984.74299928035*TMath.Power(Q2,2)*c43 - 11869.254021425615*TMath.Power(Q2,3)*c43 - 317.06597212769657*TMath.Power(Q2,4)*c43 + 7.398931465695246e-14*TMath.Power(Q2,5)*c43 - 3.062843224014919e-14*TMath.Power(Q2,6)*c43 + 2.9239680959256302e-30*TMath.Power(Q2,7)*c43 + 1493.3376435842813*TMath.Sqrt(0.1753196 + Q2)*c43 + 11753.964672167069*Q2*TMath.Sqrt(0.1753196 + Q2)*c43 + 18399.4002432735*TMath.Power(Q2,2)*TMath.Sqrt(0.1753196 + Q2)*c43 + 4181.145194655366*TMath.Power(Q2,3)*TMath.Sqrt(0.1753196 + Q2)*c43 + 1.283613528075562e-13*TMath.Power(Q2,4)*TMath.Sqrt(0.1753196 + Q2)*c43 - 2.45581825579011e-14*TMath.Power(Q2,5)*TMath.Sqrt(0.1753196 + Q2)*c43 - 1.6834621323120026e-30*TMath.Power(Q2,6)*TMath.Sqrt(0.1753196 + Q2)*c43 - 9.746560319752095e-31*TMath.Power(Q2,7)*TMath.Sqrt(0.1753196 + Q2)*c43 + 30.74487768473907*c44 + 443.04955200960944*Q2*c44 + 1975.375781718158*TMath.Power(Q2,2)*c44 + 2495.734276064423*TMath.Power(Q2,3)*c44 + 481.2471429475913*TMath.Power(Q2,4)*c44 - 1.9993049641800775e-13*TMath.Power(Q2,5)*c44 + 1.911653166569117e-29*TMath.Power(Q2,6)*c44 + 4.8732801598760474e-31*TMath.Power(Q2,7)*c44 - 73.42729648870697*TMath.Sqrt(0.1753196 + Q2)*c44 - 848.7153938248936*Q2*TMath.Sqrt(0.1753196 + Q2)*c44 - 2507.786326864199*TMath.Power(Q2,2)*TMath.Sqrt(0.1753196 + Q2)*c44 - 1470.3170224341618*TMath.Power(Q2,3)*TMath.Sqrt(0.1753196 + Q2)*c44 + 4.928176851961727e-13*TMath.Power(Q2,4)*TMath.Sqrt(0.1753196 + Q2)*c44 + 3.06284322401492e-14*TMath.Power(Q2,5)*TMath.Sqrt(0.1753196 + Q2)*c44 - 4.873280159876048e-30*TMath.Power(Q2,6)*TMath.Sqrt(0.1753196 + Q2)*c44)/ TMath.Power(0.9774045204427637 + TMath.Sqrt(0.1753196 + Q2),16))
  return err*abs(scale)*-1.2723*-1.2723


  




def GetGraphErr2( graph, par ):
  n = graph.GetN()
  ret= ROOT.TGraphErrors()
  for i in range(n):
    Q2=graph.GetX()[i]
    ret.SetPoint(i, Q2, Zexp(Q2, par) )
  
  return ret





tejin_par = [1.98548, -0.365072, -4.21083, 8.14916]
tejin_cov = [[0.0143244, -0.00346053, -0.11329, 0.151811], [-0.00346053, 0.218173, -0.428504, 0.277579], [-0.11329, -0.428504, 1.98419, -2.29539], [0.151811, 0.277579, -2.29539, 3.60688]]
tejin_par2= [1.42921, -1.05749, 0.0869732, 0.233176]
tejin_cov2= [[0.00319851, -8.4053e-6, -0.0172672, 0.0192075], [-8.4053e-6, 0.0275623, -0.020074, -0.0137733], [-0.0172672, -0.020074, 0.108674, -0.0932364], [0.0192075, -0.0137733, -0.0932364, 0.166342]]
joint_par = [2.32025, -0.613201, -5.47307, 8.24114]
joint_cov = [[0.00283471, 0.00393706, -0.0383547, 0.053355], [0.00393706, 0.16919, -0.37654, 0.249133], [-0.0383547, -0.37654, 1.22638, -1.31461], [0.053355, 0.249133, -1.31461, 2.15037]]
meyer_par = [2.28, 0.25, -5.2, 2.6]
meyer_cov = [[0.0064,0.0266,-0.124752,0.131976],[0.0266,0.9025,-1.96213,0.941355],[-0.124752,-1.96213,5.29,-4.25385],[0.131976,0.941355,-4.25385,7.29]]
